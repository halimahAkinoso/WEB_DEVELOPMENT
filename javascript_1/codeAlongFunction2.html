<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Funtion</title>
</head>
<body>
    
<script>
    // Function expressions (storing function in a variable)
const calculateTax = function(amount, rate) {
    return amount * rate;
};

console.log("Tax on $100 at 8.5%:", calculateTax(100, 0.085));

// Arrow functions (modern, shorter syntax)
const convertToFahrenheit = (celsius) => {
    return (celsius * 9/5) + 32;
};

// Even shorter arrow function (one-line)
const convertToCelsius = fahrenheit => (fahrenheit - 32) * 5/9;

console.log("25°C in Fahrenheit:", convertToFahrenheit(25));
console.log("77°F in Celsius:", convertToCelsius(77).toFixed(1));

console.log(""); // Empty line

// Functions that call other functions
function calculateBMI(weight, height) {
    return weight / (height * height);
}

function getBMICategory(bmi) {
    if (bmi < 18.5) return "Underweight";
    if (bmi < 25) return "Normal weight";
    if (bmi < 30) return "Overweight";
    return "Obese";
}

function healthCheck(weight, height) {
    const bmi = calculateBMI(weight, height);
    const category = getBMICategory(bmi);
    return {
        bmi: bmi.toFixed(1),
        category: category,
        message: `Your BMI is ${bmi.toFixed(1)} (${category})`
    };
}

// Test the health check system
const result = healthCheck(70, 1.75); // 70kg, 1.75m
console.log("Health Check Result:");
console.log(result.message);

console.log(""); // Empty line

// Function with multiple return paths
function getDiscountMessage(totalAmount, membershipType) {
    if (totalAmount < 50) {
        return "Minimum order is $50 for discounts.";
    }
    
    if (membershipType === "gold") {
        return `Gold member discount: ${totalAmount * 0.15}`;
    }
    
    if (membershipType === "silver") {
        return `Silver member discount: ${totalAmount * 0.10}`;
    }
    
    return "Regular customer - no discount available.";
}

// Test discount messages
console.log("Discount examples:");
console.log(getDiscountMessage(30, "gold"));
console.log(getDiscountMessage(100, "gold"));
console.log(getDiscountMessage(100, "silver"));
console.log(getDiscountMessage(100, "regular"));

// Pattern 1: Validation function
function isValidEmail(email) {
    return email.includes("@") && email.includes(".");
}

// Pattern 2: Formatter function
function formatCurrency(amount) {
    return `$${amount.toFixed(2)}`;
}

// Pattern 3: Decision maker function
function shouldBuyItem(price, budget, necessity) {
    if (necessity === "essential") {
        return price <= budget;
    } else if (necessity === "important") {
        return price <= budget * 0.7;
    } else {
        return price <= budget * 0.3;
    }
}

// Pattern 4: Data processor function
function analyzeGrades(grades) {
    const total = grades.reduce((sum, grade) => sum + grade, 0);
    const average = total / grades.length;
    const highest = Math.max(...grades);
    const lowest = Math.min(...grades);
    
    return {
        average: average.toFixed(1),
        highest: highest,
        lowest: lowest,
        letterGrade: average >= 90 ? "A" : average >= 80 ? "B" : average >= 70 ? "C" : "F"
    };
}

// Test all patterns
console.log("Function Pattern Examples:");
console.log(""); // Empty line

console.log("Email validation:");
console.log(isValidEmail("user@example.com")); // true
console.log(isValidEmail("invalid-email"));    // false

console.log(""); // Empty line

console.log("Currency formatting:");
console.log(formatCurrency(1234.5));  // $1234.50

console.log(""); // Empty line

console.log("Purchase decision:");
console.log("$100 item, $500 budget, essential:", shouldBuyItem(100, 500, "essential"));
console.log("$100 item, $500 budget, luxury:", shouldBuyItem(100, 500, "luxury"));

console.log(""); // Empty line

console.log("Grade analysis:");
const studentGrades = [88, 92, 76, 94, 89];
const analysis = analyzeGrades(studentGrades);
console.log(`Average: ${analysis.average}% (${analysis.letterGrade})`);
console.log(`Range: ${analysis.lowest} - ${analysis.highest}`);

// Global scope - available everywhere
let globalMessage = "I'm available everywhere";

function demonstrateScope() {
    // Function scope - only available inside this function
    let functionMessage = "I'm only available in this function";
    
    console.log("Inside function:");
    console.log("Global message:", globalMessage);  // ✅ Can access global
    console.log("Function message:", functionMessage); // ✅ Can access local
    
    // Block scope with if statement
    if (true) {
        let blockMessage = "I'm only available in this block";
        console.log("Block message:", blockMessage); // ✅ Can access in same block
        
        // Can access both global and function variables from inside block
        console.log("From block - Global:", globalMessage);
        console.log("From block - Function:", functionMessage);
    }
    
    // Trying to access block variable outside the block would cause an error
    // console.log("Block message outside:", blockMessage); // ❌ Error!
}

// Call the function
demonstrateScope();

// Trying to access function variable outside the function would cause an error
// console.log("Function message outside:", functionMessage); // ❌ Error!

console.log("Outside function - Global message:", globalMessage); // ✅ Works

console.log(""); // Empty line

// Practical scope example with functions
function calculateTotal(price, taxRate) {
    // Parameters (price, taxRate) are function-scoped
    let subtotal = price;  // Function-scoped variable
    
    if (taxRate > 0) {
        let tax = subtotal * taxRate;  // Block-scoped variable
        let total = subtotal + tax;    // Block-scoped variable
        
        return {
            subtotal: subtotal,
            tax: tax,
            total: total
        };
    }
    
    // tax and total variables don't exist here
    return {
        subtotal: subtotal,
        tax: 0,
        total: subtotal
    };
}

let purchase = calculateTotal(100, 0.08);
console.log("Purchase calculation:", purchase);

console.log(""); // Empty line

// Example showing why scope matters
let counter = 0; // Global counter

function incrementGlobal() {
    counter++; // Modifies global variable
    console.log("Global counter:", counter);
}

function incrementLocal() {
    let counter = 0; // Local variable (different from global)
    counter++;
    console.log("Local counter:", counter);
}

incrementGlobal(); // Changes global counter to 1
incrementGlobal(); // Changes global counter to 2
incrementLocal();  // Uses local counter (always shows 1)
incrementLocal();  // Uses local counter (always shows 1)
console.log("Final global counter:", counter); // Still 2

</script>

</body>
</html>